(()=>{"use strict";Module.register("MMM-Eye-Film",{requiresVersion:"2.12.0",defaults:{refreshInterval:6e5,maxEntries:20,getStartTime:()=>moment().toISOString(),getEndTime:()=>moment().endOf("day").toISOString()},start(){this.sendNotification(),setInterval((()=>this.sendNotification()),this.config.refreshInterval)},sendNotification:function(){const t={startDateTime:this.config.getStartTime(),endDateTime:this.config.getEndTime(),siteId:this.translate("siteId")};this.sendSocketNotification("REFRESH_SHOWS",t)},shows:[],error:null,getDom:function(){return this.getTable()},getHeader:function(){return this.translate("TODAY_IN_EYE")},getScripts:function(){return["moment.js"]},getStyles:()=>["MMM-Eye-Film.css"],getTranslations:function(){return{en:"translations/en.json",nl:"translations/nl.json"}},socketNotificationReceived(t,e){switch(t){case"EYE_FILM_SHOWS":this.removeError(),this.setShows(e.shows),this.updateDom();break;case"EYE_FILM_ERROR":this.setError(e.error),this.updateDom()}},setShows(t){this.shows=t},setError(t){this.error=t},removeError(){this.setError(null)},getTable(){const t=document.createElement("table");if(t.classList.add("eye-film-table","light","small"),this.error){const e=document.createElement("tr");e.classList.add("xsmall");const n=document.createElement("td");n.colSpan=3,n.innerText=this.error,e.appendChild(n),t.appendChild(e)}return this.shows.slice(0,this.config.maxEntries).forEach((e=>{const n=e.production[0];if("Available"!==e.ticketStatus)return;const i=n.mainTheme.map((t=>t.title)),s=(n.tag.map((t=>t.title)),i.join(", ")),r=document.createElement("tr"),a=document.createElement("tr"),o=document.createElement("td"),l=document.createElement("td"),c=document.createElement("td"),d=document.createElement("td");o.innerText=n.title,o.classList.add("bright"),l.innerText=s,l.classList.add("no-wrap"),c.innerText=moment(e.startDateTime).calendar(),c.classList.add("no-wrap","start-time"),d.innerText=n.tagline,d.classList.add("tagline","xsmall"),d.colSpan=3,r.appendChild(c),r.appendChild(o),a.appendChild(d),t.appendChild(r),t.appendChild(a)})),t}})})();